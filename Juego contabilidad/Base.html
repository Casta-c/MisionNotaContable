<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Misi√≥n: Nota Contable</title>

<style>
body {
    font-family: Arial;
    background:#101010;
    color:white;
    padding:20px;
}
#game {
    max-width: 750px;
    margin:auto;
    background:#1f1f1f;
    padding:20px;
    border-radius:10px;
}
h1 {
    text-align:center;
    color:#4ee44e;
}
.btn {
    background:#4ee44e;
    color:black;
    padding:12px;
    margin:10px 0;
    border:none;
    width:100%;
    cursor:pointer;
    border-radius:8px;
    font-size:16px;
}
.btn:hover { background:#74ff74; }

#stats {
    margin-top:20px;
    background:#242424;
    padding:10px;
    border-radius:8px;
}
</style>
</head>
<body>

<div id="game">
    <h1>MISI√ìN: NOTA CONTABLE</h1>
    <p id="text"></p>
    <div id="choices"></div>
    <div id="stats"></div>
</div>

<script>
let activos = 1000;
let pasivos = 500;
let patrimonio = 500;
let errores = 0;

function actualizarStats(){
    document.getElementById("stats").innerHTML = `
        <b>Activos:</b> $${activos} |
        <b>Pasivos:</b> $${pasivos} |
        <b>Patrimonio:</b> $${patrimonio} |
        <b>Errores cometidos:</b> ${errores}/3
    `;
}

function elegir(opciones){
    const cont = document.getElementById("choices");
    cont.innerHTML = "";
    opciones.forEach(op=>{
        let btn = document.createElement("button");
        btn.className = "btn";
        btn.textContent = op.texto;
        btn.onclick = op.accion;
        cont.appendChild(btn);
    });
}

function perder(motivo){
    document.getElementById("text").innerHTML = `
        <h2 style="color:red;">HAS PERDIDO</h2>${motivo}
    `;
    document.getElementById("choices").innerHTML =
        `<button class="btn" onclick="inicio()">Jugar otra vez</button>`;
}

function ganar(){
    document.getElementById("text").innerHTML = `
        <h2 style="color:#4ee44e;">¬°HAS COMPLETADO TODAS LAS NOTAS CONTABLES!</h2>
        La empresa queda perfectamente cuadrada gracias a ti.
    `;
    document.getElementById("choices").innerHTML =
        `<button class="btn" onclick="inicio()">Jugar otra vez</button>`;
}

function inicio(){
    activos = 1000;
    pasivos = 500;
    patrimonio = activos - pasivos;
    errores = 0;
    actualizarStats();

    document.getElementById("text").innerHTML = `
        Eres el nuevo auxiliar contable.<br><br>
        La empresa est√° a punto de una auditor√≠a y tu misi√≥n es sencilla (en teor√≠a):<br>
        <b>Registrar correctamente todas las notas contables que te pidan.</b><br><br>
        Tienes solo 3 oportunidades antes de que te despidan.
    `;

    elegir([
        { texto:"Comenzar misi√≥n", accion: nota1 }
    ]);
}

////////////////////////////////////////////////////////////
// FUNCI√ìN NUEVA: EXPLICAR EJEMPLO
////////////////////////////////////////////////////////////

function mostrarEjemplo(){
    document.getElementById("text").innerHTML = `
        <h3>üìò Ejemplo: C√≥mo elegir la opci√≥n correcta</h3>

        <b>Situaci√≥n:</b> Se compra papeler√≠a por $200 en efectivo.<br><br>

        <b>¬øQu√© significa esto?</b><br>
        ‚úî Entra papeler√≠a ‚Üí aumenta un activo ‚Üí <b>se registra como CARGO</b><br>
        ‚úî Sale dinero de la caja ‚Üí disminuye un activo ‚Üí <b>se registra como ABONO</b><br><br>

        <b>Por lo tanto, la opci√≥n correcta es:</b><br>
        <span style="color:#4ee44e;">
        Cargo: Papeler√≠a (Activo) | Abono: Caja (Activo)
        </span><br><br>

        Cuando est√©s listo, vuelve a la nota.
    `;

    elegir([
        { texto:"Volver a la nota", accion: nota1 }
    ]);
}

////////////////////////////////////////////////////////////
// NOTA 1 ‚Äì Compra de papeler√≠a (CON BOT√ìN DE EJEMPLO)
////////////////////////////////////////////////////////////

function nota1(){
    document.getElementById("text").innerHTML = `
        <b>NOTA 1:</b> La empresa compr√≥ papeler√≠a por $200 en efectivo.<br><br>
        Antes de elegir, puedes ver un ejemplo de c√≥mo funcionan las notas contables.
    `;
    elegir([
        { texto:"üìò Ver ejemplo", accion: mostrarEjemplo },
        { texto:"Cargo: Papeler√≠a (Activo) | Abono: Caja (Activo)", accion: ()=>correcto_nota1() },
        { texto:"Cargo: Caja | Abono: Papeler√≠a", accion: ()=>error_nota(nota1) },
        { texto:"No registrar nada", accion: ()=>error_nota(nota1) }
    ]);
}

function correcto_nota1(){
    activos -= 200; // sali√≥ efectivo
    activos += 200; // entr√≥ papeler√≠a (activo)
    patrimonio = activos - pasivos;
    actualizarStats();

    document.getElementById("text").innerHTML = `
        ‚úî Correcto. Registraste la compra adecuadamente.<br><br>
        Siguiente situaci√≥n‚Ä¶
    `;
    elegir([{ texto:"Continuar", accion: nota2 }]);
}

////////////////////////////////////////////////////////////
// NOTA 2 ‚Äì Cliente paga deuda
////////////////////////////////////////////////////////////

function nota2(){
    document.getElementById("text").innerHTML = `
        <b>NOTA 2:</b> Un cliente paga una deuda pendiente de $300.<br><br>
        ¬øC√≥mo registras la nota?
    `;
    elegir([
        { texto:"Cargo: Caja | Abono: Cuentas por cobrar", accion: ()=>correcto_nota2() },
        { texto:"Cargo: Pasivo | Abono: Caja", accion: ()=>error_nota(nota2) },
        { texto:"Cargo: Ventas | Abono: Caja", accion: ()=>error_nota(nota2) }
    ]);
}

function correcto_nota2(){
    activos += 300;
    patrimonio = activos - pasivos;
    actualizarStats();

    document.getElementById("text").innerHTML = `
        ‚úî Correcto. Aumenta tu caja y reduces la cuenta por cobrar.<br><br>
        Vamos con una operaci√≥n m√°s peligrosa‚Ä¶
    `;
    elegir([{ texto:"Continuar", accion: nota3 }]);
}

////////////////////////////////////////////////////////////
// NOTA 3 ‚Äì Ajuste por error
////////////////////////////////////////////////////////////

function nota3(){
    document.getElementById("text").innerHTML = `
        <b>NOTA 3:</b> Descubres que ayer registraron un gasto de m√°s por $150 por error.<br><br>
        Debes corregirlo. ¬øQu√© haces?
    `;
    elegir([
        { texto:"Cargo: Gastos | Abono: Caja", accion: ()=>error_nota(nota3) },
        { texto:"Cargo: Caja | Abono: Gastos", accion: ()=>correcto_nota3() },
        { texto:"Ignorar el error", accion: ()=>error_nota(nota3) }
    ]);
}

function correcto_nota3(){
    activos += 150;
    patrimonio = activos - pasivos;
    actualizarStats();

    document.getElementById("text").innerHTML = `
        ‚úî Buen trabajo. Corrigiste el error contable.<br><br>
        Vamos a la √∫ltima nota‚Ä¶
    `;
    elegir([{ texto:"Continuar", accion: notaFinal }]);
}

////////////////////////////////////////////////////////////
// NOTA FINAL ‚Äì Registro de maquinaria
////////////////////////////////////////////////////////////

function notaFinal(){
    document.getElementById("text").innerHTML = `
        <b>NOTA FINAL:</b><br>
        La empresa recibe una m√°quina valorada en $1000, pero a√∫n NO la ha pagado.<br><br>
        ¬øQu√© nota contable registras?
    `;
    elegir([
        { texto:"Cargo: Maquinaria | Abono: Proveedores (Pasivo)", accion: ()=>final_correcto() },
        { texto:"Cargo: Caja | Abono: Maquinaria", accion: ()=>error_nota(notaFinal) },
        { texto:"No registrar nada hasta que se pague", accion: ()=>error_nota(notaFinal) }
    ]);
}

function final_correcto(){
    activos += 1000;
    pasivos += 1000;
    patrimonio = activos - pasivos;
    actualizarStats();
    ganar();
}

////////////////////////////////////////////////////////////
// SISTEMA DE ERRORES
////////////////////////////////////////////////////////////

function error_nota(volvera){
    errores++;
    actualizarStats();

    if(errores >= 3){
        perder("Cometiste 3 errores de nota contable. La auditor√≠a fue un desastre.");
        return;
    }

    document.getElementById("text").innerHTML =
        `‚ùå Esa nota es incorrecta.<br><br>¬øQuieres intentarlo de nuevo?`;

    elegir([
        { texto:"Reintentar", accion: volvera },
        { texto:"Rendirme", accion: ()=>perder("Abandonaste la misi√≥n.") }
    ]);
}

inicio();
</script>

</body>
</html>
